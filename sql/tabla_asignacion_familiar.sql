
create table rem_tabla_asig_familiar_periodo (
id int identity,
tramo char(1),
desde bigint,
hasta bigint,
monto bigint,
periodo int,
created_at datetime default getdate()
)

insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 342346, 13401, 202101)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 342347, 500033, 8224, 202101)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 500034, 779882, 2599, 202101)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 779883, 999999999, 0, 202101)



insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 342346, 13401, 202102)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 342347, 500033, 8224, 202102)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 500034, 779882, 2599, 202102)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 779883, 999999999, 0, 202102)





insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 342346, 13401, 202103)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 342347, 500033, 8224, 202103)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 500034, 779882, 2599, 202103)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 779883, 999999999, 0, 202103)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 342346, 13401, 202104)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 342347, 500033, 8224, 202104)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 500034, 779882, 2599, 202104)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 779883, 999999999, 0, 202104)





insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202105)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202105)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202105)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202105)


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202106)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202106)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202106)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202106)


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202107)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202107)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202107)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202107)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202108)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202108)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202108)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202108)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202109)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202109)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202109)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202109)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202110)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202110)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202110)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202110)



insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202111)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202111)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202111)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202111)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 353356, 13832, 202112)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 353357, 516114, 8488, 202112)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 516115, 804962, 2683, 202112)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 804963, 999999999, 0, 202112)






insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202201)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202201)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202201)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202201)



insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202202)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202202)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202202)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202202)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202203)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202203)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202203)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202203)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202204)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202204)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202204)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202204)





insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202205)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202205)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202205)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202205)



insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 366987, 14366, 202206)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 366988, 536023, 8815, 202206)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 536024, 836014, 2786, 202206)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 836015, 999999999, 0, 202206)



update		p
set			hasta = 398443
			,monto = 15597
--select		*
from		rem_tabla_asig_familiar_periodo p
where		tramo = 'A'
and			periodo in (202205,202206)



update		p
set			desde = 398444
			,hasta = 581968
			,monto = 9571
--select		*
from		rem_tabla_asig_familiar_periodo p
where		tramo = 'B'
and			periodo in (202205,202206)


update		p
set			desde = 581969
			,hasta = 907672
			,monto = 3025
--select		*
from		rem_tabla_asig_familiar_periodo p
where		tramo = 'C'
and			periodo in (202205,202206)


update		p
set			desde = 907673
			,hasta = 999999999
			,monto = 0
--select		*
from		rem_tabla_asig_familiar_periodo p
where		tramo = 'D'
and			periodo in (202205,202206)


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto,periodo)
select	tramo, desde, hasta, monto, 202207 as periodo
from		rem_tabla_asig_familiar_periodo
where		periodo = 202206


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto,periodo)
select	tramo, desde, hasta, monto, 202208 as periodo
from		rem_tabla_asig_familiar_periodo
where		periodo = 202207


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 419414, 16418, 202209)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 419415, 612598, 10075, 202209)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 612599, 955444, 3184, 202209)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 955445, 999999999, 0, 202209)




insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 419414, 16418, 202210)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 419415, 612598, 10075, 202210)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 612599, 955444, 3184, 202210)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 955445, 999999999, 0, 202210)





insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 429899, 16828, 202301)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 429900, 627913, 10327, 202301)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 627914, 979330, 3264, 202301)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 979331, 999999999, 0, 202301)


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto,periodo)
select	tramo, desde, hasta, monto, 202303 as periodo
from		rem_tabla_asig_familiar_periodo
where		periodo = 202302

insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto,periodo)
select	tramo, desde, hasta, monto, 202304 as periodo
from		rem_tabla_asig_familiar_periodo
where		periodo = 202302


insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('A', 1, 515879, 20328, 202305)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('B', 515880, 753496, 12475, 202305)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('C', 753497, 1175196, 3942, 202305)
insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto, periodo) values ('D', 1175197, 999999999, 0, 202305)

insert into rem_tabla_asig_familiar_periodo (tramo, desde, hasta, monto,periodo)
select	tramo, desde, hasta, monto, 202306 as periodo
from		rem_tabla_asig_familiar_periodo
where		periodo = 202305